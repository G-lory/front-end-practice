<!DOCTYPE html>
<html>
<head>
    <meta charset="utf-8" />
    <title>lesson2-03</title>
    <style>
        body {
            text-align: center;
        }
        .input {
            width: 200px;
        }
        .hint {
            font-size: 12px;
            color: gray;
        }
        .res {
            color: red;
            font-size: 16px;
            font-weight: bold;
        }
    </style>
</head>
<body>
    <p>
        <input type="text" value="1,2,3,4,5,6,7,8,9,10,11,12,13,14,15" class="input" onkeyup="handleChange(this.value)">
        <span class="hint">输入数字求和，数字之间用半角","号分隔</span>
    </p>
    <p><button onclick="cal()">求和</button></p>
    <p><span class="res"></span></p>
    <script>
        function cal() {
            const input = document.getElementsByTagName('input')[0].value
            console.log(input)
            let sum = 0
            input.split(',').map(item => {
                sum += parseInt(item) || 0
            })
            console.log(sum)
            document.getElementsByClassName('res')[0].innerHTML = sum
        }
        function handleChange(inputStr) {
            for (let i = 0; i < inputStr.length; i++) {
                if (!/^\d|,$/.test(inputStr[i])) {
                    document.getElementsByTagName('input')[0].value = inputStr.slice(0, i)
                    break
                }
            }
        }
    </script>
</body>
</html>